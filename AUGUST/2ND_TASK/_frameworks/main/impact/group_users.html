{header}
<style type="text/css">
.groupTable {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
}
.groupTable th, .groupTable td {
    padding: 8px;
    text-align: left;
}
.groupTable th {
    background-color: #ddd;
    color: #333;
}
.groupTable tbody tr:nth-child(odd) {
    background-color: #f2f2f2;
}
.groupTable tbody tr:nth-child(even) {
    background-color: white;
}
.groupLink {
    display: block;
    padding-bottom: 15px;
    text-decoration: underline;
}
.text-right {text-align: right !important;}
.groupTable a {color: #6d8fff}
</style>
<script type="text/javascript">
    var m="{message}";
    if (m != "") {
        alertCustom("{message}");
    }
    function ban(uid) {
        redirectUrl('group_users?ban='+uid);
    }

    function one_delete(uid) {
        redirectUrl('group_users?delete='+uid);
    }
</script>
<div class="col_center">
    <div class="head icon_head_visitors">{page_title}</div>
    <span id="add_group_user_link"></span>
    <div class="cont" id="tableData"></div>
</div>
<script type="text/javascript">
    $(function(){
        // set active color
        var groupUsersLink = document.querySelector('a[href="./group_users"]');
        groupUsersLink.style.color = '#8ad4ff';

        // previllage
        const gadmin_previllage = '{gadmin_previllage}';
        const previllage = gadmin_previllage.split(",");

        if(previllage[0] == 1) // add
            $("#add_group_user_link").html(`<a href="{main_url}add_user" class="groupLink">{l_add_group_user}</a>`)

        // preloader
        $("#tableData").html(`<div id="loader_messages" class="css_loader loader_messages"><div class="spinner center"><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div></div></div>`)
        
        $.ajax({
            url: 'group_users',
            type: "POST",
            dataType: "json",
            data:{ "cmd": "get_group_user_data", "cmd_ajax": 1},
            success:function(response){
                if(response.length) {
                    var tableData = `<table class="groupTable">
                        <thead>
                            <tr>
                                <th>{l_action}</th>
                                <th>{l_name}</th>
                                <th>{l_email_address}</th>
                                <th>{l_orientation}</th>
                                <th>{l_age}</th>
                                <th class="text-right">{l_register}</th>
                            </tr>
                        </thead>
                        <tbody>`;


                    for(var i=0; i < response.length; i++) {
                        var editTxt = delTxt = line = ""
                        if(previllage[1] == 1) // edit
                            editTxt = `<a href="{url_main}edit_user?name=${response[i].name_seo}">Edit</a>`

                        if(previllage[1] == 1 && previllage[2] == 1)
                            line = ` | `

                        if(previllage[2] == 1) // delete
                            delTxt = `<a href="" onclick="confirmCustom('{j_are_you_sure}',function(){one_delete(${response[i].user_id})}); return false;" style="color: #f00">Delete</a>`
                        
                        var banTxt = ` | <a href="" onclick="confirmCustom('{j_are_you_sure}',function(){ban(${response[i].user_id})}); return false;">${response[i].banData}</a>`;

                        tableData+= '<tr><td style="white-space: nowrap">'+editTxt+line+delTxt+banTxt+'</td>';
                        tableData += `
                            <td><a href="{url_main}${response[i].name_seo}" target="_blank">${response[i].name}</a></td>
                            <td>${response[i].mail}</td>
                            <td>${response[i].gender}</td>
                            <td>${response[i].age}</td>
                            <td class="text-right">${response[i].register}</td>
                        </tr>`
                    }                        

                    tableData += `</tbody></table>`;

                    $("#tableData").html(tableData)

                } else
                    $("#tableData").html(`<div id="im_list_users_empty" style="display: block;"><div class="dialog pp_message_user_info"><div class="bl"><img src="{url_tmpl_main}images/icon_upgrade_profile_visitors.png" width="239" height="207" alt="No users"><div class="bl_txt_msg_empty"><span>You have no users yet.</span></div></div></div></div>`)
            }
        })
    })
</script>
{footer}